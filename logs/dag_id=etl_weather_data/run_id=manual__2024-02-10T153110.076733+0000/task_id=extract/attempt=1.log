[2024-02-10T15:31:14.362+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_weather_data.extract manual__2024-02-10T15:31:10.076733+00:00 [queued]>
[2024-02-10T15:31:14.378+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_weather_data.extract manual__2024-02-10T15:31:10.076733+00:00 [queued]>
[2024-02-10T15:31:14.380+0000] {taskinstance.py:2171} INFO - Starting attempt 1 of 2
[2024-02-10T15:31:14.593+0000] {taskinstance.py:2192} INFO - Executing <Task(PythonOperator): extract> on 2024-02-10 15:31:10.076733+00:00
[2024-02-10T15:31:14.603+0000] {standard_task_runner.py:60} INFO - Started process 173 to run task
[2024-02-10T15:31:14.606+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_weather_data', 'extract', 'manual__2024-02-10T15:31:10.076733+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag.py', '--cfg-path', '/tmp/tmp64r119_v']
[2024-02-10T15:31:14.611+0000] {standard_task_runner.py:88} INFO - Job 24: Subtask extract
[2024-02-10T15:31:14.680+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_weather_data.extract manual__2024-02-10T15:31:10.076733+00:00 [running]> on host 407ed8c69d77
[2024-02-10T15:31:14.791+0000] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Lucas Andrini' AIRFLOW_CTX_DAG_ID='etl_weather_data' AIRFLOW_CTX_TASK_ID='extract' AIRFLOW_CTX_EXECUTION_DATE='2024-02-10T15:31:10.076733+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-02-10T15:31:10.076733+00:00'
[2024-02-10T15:31:14.793+0000] {etl_dag.py:56} INFO - Contenido de variables de entorno:
environ({'AIRFLOW__CELERY__RESULT_BACKEND': 'db+postgresql://***:***@postgres/***', 'DUMB_INIT_SETSID': '0', 'REDSHIFT_PORT': '5439', 'HOSTNAME': '407ed8c69d77', 'PYTHON_VERSION': '3.8.18', 'LANGUAGE': 'C.UTF-8', 'REDSHIFT_PASSWORD': 'CIpG6k50To', 'REDSHIFT_USER': 'lucas_andrini_coderhouse', 'AIRFLOW_USER_HOME_DIR': '/home/***', 'REDSHIFT_HOST': 'data-engineer-cluster.cyhh5bfevlmn.us-east-1.redshift.amazonaws.com', 'ADDITIONAL_RUNTIME_APT_DEPS': '', 'PWD': '/opt/***', 'AIRFLOW__CELERY__BROKER_URL': 'redis://:@redis:6379/0', 'AIRFLOW_VERSION': '2.8.0', 'AIRFLOW__CORE__LOAD_EXAMPLES': 'false', 'AIRFLOW__API__AUTH_BACKENDS': '***.api.auth.backend.basic_auth,***.api.auth.backend.session', 'INSTALL_MSSQL_CLIENT': 'true', 'PYTHON_SETUPTOOLS_VERSION': '57.5.0', 'INSTALL_MYSQL_CLIENT_TYPE': 'mariadb', 'OPENWEATHERMAP_API_KEY': '654c7b47cda32dc0a894e1a875c3b9a2', 'GUNICORN_CMD_ARGS': '--worker-tmp-dir /dev/shm', 'LD_PRELOAD': '/usr/lib/x86_64-linux-gnu/libstdc++.so.6', 'HOME': '/home/***', 'LANG': 'C.UTF-8', 'REMITENTE': 'lucasandrini01@gmail.com', 'AIRFLOW_HOME': '/opt/***', 'GPG_KEY': 'E3FF2839C048B25C084DEBE9B26995E310250568', 'AIRFLOW__DATABASE__SQL_ALCHEMY_CONN': 'postgresql+psycopg2://***:***@postgres/***', 'AIRFLOW__CORE__EXECUTOR': 'CeleryExecutor', 'COMMIT_SHA': '11ec4100b3ffb86e15b43a8dde5f53f07d404508', 'AIRFLOW_PIP_VERSION': '23.3.2', 'AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION': 'true', 'PASSWORD': 'zpbp fcvm ocgo hzge', 'ADDITIONAL_RUNTIME_APT_COMMAND': '', '_PIP_ADDITIONAL_REQUIREMENTS': '', 'INSTALL_POSTGRES_CLIENT': 'true', 'SHLVL': '0', 'LC_MESSAGES': 'C.UTF-8', 'RUNTIME_APT_DEPS': '', 'PYTHON_PIP_VERSION': '23.0.1', 'RUNTIME_APT_COMMAND': 'echo', 'LD_LIBRARY_PATH': '/usr/local/lib', 'LC_CTYPE': 'C.UTF-8', 'AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK': 'true', 'PYTHON_GET_PIP_SHA256': '9cc01665956d22b3bf057ae8287b035827bfd895da235bcea200ab3b811790b6', 'DESTINATARIO': 'lucasandrini01@gmail.com', 'AIRFLOW_INSTALLATION_METHOD': '', 'LC_ALL': 'C.UTF-8', 'PYTHON_GET_PIP_URL': 'https://github.com/pypa/get-pip/raw/4cfa4081d27285bda1220a62a5ebf5b4bd749cdb/public/get-pip.py', 'INSTALL_MYSQL_CLIENT': 'true', 'REDSHIFT_DATABASE': 'data-engineer-database', 'PATH': '/root/bin:/home/***/.local/bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'PYTHON_BASE_IMAGE': 'python:3.8-slim-bookworm', 'AIRFLOW_UID': '50000', 'BUILD_ID': '', 'AIRFLOW__CORE__FERNET_KEY': '', 'DEBIAN_FRONTEND': 'noninteractive', '_MP_FORK_LOGLEVEL_': '20', '_MP_FORK_LOGFILE_': '', '_MP_FORK_LOGFORMAT_': '[%(asctime)s: %(levelname)s/%(processName)s] %(message)s', 'CELERY_LOG_LEVEL': '20', 'CELERY_LOG_FILE': '', 'CELERY_LOG_REDIRECT': '1', 'CELERY_LOG_REDIRECT_LEVEL': 'WARNING', '_AIRFLOW_PARSING_CONTEXT_DAG_ID': 'etl_weather_data', '_AIRFLOW_PARSING_CONTEXT_TASK_ID': 'extract', 'AIRFLOW_CTX_DAG_OWNER': 'Lucas Andrini', 'AIRFLOW_CTX_DAG_ID': 'etl_weather_data', 'AIRFLOW_CTX_TASK_ID': 'extract', 'AIRFLOW_CTX_EXECUTION_DATE': '2024-02-10T15:31:10.076733+00:00', 'AIRFLOW_CTX_TRY_NUMBER': '1', 'AIRFLOW_CTX_DAG_RUN_ID': 'manual__2024-02-10T15:31:10.076733+00:00'})
[2024-02-10T15:31:14.794+0000] {etl_dag.py:59} INFO - Contenido de config.ini:
ItemsView(<configparser.ConfigParser object at 0x7fc08b77d370>)
[2024-02-10T15:31:15.863+0000] {etl_dag.py:84} INFO - Extracción de datos para la ciudad (-34.61, -58.38) ok.
[2024-02-10T15:31:16.953+0000] {etl_dag.py:84} INFO - Extracción de datos para la ciudad (-56.18, -34.9) ok.
[2024-02-10T15:31:17.030+0000] {etl_dag.py:93} INFO - Contenido del DataFrame después de la extracción:
                                coord  ...  cod
0  {'lon': -58.3772, 'lat': -34.6132}  ...  200
1       {'lon': -34.9, 'lat': -56.18}  ...  200

[2 rows x 13 columns]
[2024-02-10T15:31:17.032+0000] {python.py:201} INFO - Done. Returned value was: None
[2024-02-10T15:31:17.043+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_weather_data, task_id=extract, execution_date=20240210T153110, start_date=20240210T153114, end_date=20240210T153117
[2024-02-10T15:31:17.075+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-02-10T15:31:17.104+0000] {taskinstance.py:3281} INFO - 1 downstream tasks scheduled from follow-on schedule check
